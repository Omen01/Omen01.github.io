<!DOCTYPE html>
<html>
<head>
    <title>Anime Wordle</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            height: 100vh; 
            overflow: hidden; 
            background: #2c2f33; 
            display: flex; 
            justify-content: center; 
            padding-left: 410px; /* Desktop padding */
        }
        .container { 
            display: flex; 
            flex-direction: row; 
            align-items: flex-start; 
            width: 100%; 
            max-width: 1000px; 
            margin: 0 auto; 
        }
        .game-area { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            width: 60%; 
            max-width: 600px; 
        }
        .grid { 
            display: grid; 
            grid-template-columns: repeat(5, 50px); /* Fixed size for desktop */
            gap: 5px; 
            margin: 20px 0; 
        }
        .tile { 
            width: 50px; 
            height: 50px; 
            border: 2px solid #ccc; 
            text-align: center; 
            line-height: 50px; 
            font-size: 20px; 
        }
        .green { background: #6aaa64; color: white; border-color: #6aaa64; }
        .yellow { background: #c9b458; color: white; border-color: #c9b458; }
        .gray { background: #787c7e; color: white; border-color: #787c7e; }
        #guessInput { margin: 10px; padding: 5px; font-size: 16px; }
        button { padding: 5px 10px; font-size: 16px; margin: 5px; }
        #message { color: white; margin: 20px 0; font-size: 24px; font-weight: bold; text-align: center; }
        .keyboard { margin-top: 20px; }
        .keyboard-row { display: flex; gap: 5px; margin-bottom: 5px; }
        .key { width: 30px; height: 40px; border: 1px solid #ccc; text-align: center; line-height: 40px; background: #fff; cursor: pointer; font-size: 16px; }
        .key.green { background: #6aaa64; color: white; }
        .key.yellow { background: #c9b458; color: white; }
        .key.gray { background: #787c7e; color: white; }
        #score { color: white; margin: 10px; font-size: 16px; font-weight: bold; }
        .progress-area { display: flex; flex-direction: column; align-items: center; margin-left: 2%; }
        .progress-grid { display: grid; grid-template-columns: repeat(5, 50px); gap: 5px; }
        .progress-tile { width: 50px; height: 50px; border: 2px solid #ccc; text-align: center; line-height: 50px; font-size: 20px; background: #444; color: white; }
        #hintButton:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Media query for mobile devices (e.g., max-width: 768px) */
        @media (max-width: 768px) {
            body { padding-left: 0; } /* Remove padding on mobile */
            .container { 
                flex-direction: column; 
                align-items: center; 
                width: 100%; 
                max-width: none; 
                justify-content: flex-start; 
            }
            .game-area { 
                width: 100%; 
                max-width: none; 
                margin: 0; 
                flex-grow: 1; 
            }
            .grid { grid-template-columns: repeat(5, 20vw); margin: 10px 0; }
            .tile { width: 20vw; height: 20vw; line-height: 20vw; font-size: 7vw; }
            #guessInput { font-size: 7vw; }
            button { font-size: 6vw; padding: 10px 20px; }
            #message { font-size: 7vw; }
            .keyboard { margin-top: 10px; }
            .key { width: 14vw; height: 17vw; line-height: 17vw; font-size: 6vw; }
            #score { font-size: 6vw; }
            .progress-area { 
                margin-top: auto; 
                width: 100%; 
                order: 1; 
                text-align: center; 
            }
            .progress-grid { grid-template-columns: repeat(5, 20vw); }
            .progress-tile { width: 20vw; height: 20vw; line-height: 20vw; font-size: 7vw; }
            #hintButton { font-size: 6vw; padding: 10px 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="game-area">
            <h1>Anime Wordle</h1>
            <div id="score">Score: 0</div>
            <div class="grid" id="gameGrid"></div>
            <input type="text" id="guessInput" maxlength="5" placeholder="Enter 5-letter word" autofocus>
            <button id="guessButton">Guess</button>
            <button id="playAgainButton" style="display: none">Play Again</button>
            <p id="message"></p>
            <div class="keyboard" id="keyboard"></div>
        </div>
        <div class="progress-area">
            <h2>Progress</h2>
            <div class="progress-grid" id="progressGrid"></div>
            <button id="hintButton">Hint</button>
        </div>
    </div>

    <script>
        let words = [];
        let secret = '';
        let grid = null;
        let progressGrid = null;
        let attempts = 0;
        let maxAttempts = 6;
        let message = null;
        let keyboard = {};
        let score = 0; // Track consecutive wins
        let gameEnded = false; // Flag to track game end state
        let progress = ['', '', '', '', '']; // Track progress for each position
        let hintsUsed = 0; // Track number of hints used

        // Fetch words.txt and initialize game
        fetch('words.txt')
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.text();
            })
            .then(text => {
                words = text.trim().split('\n').map(word => word.trim().toUpperCase()).filter(word => word.length === 5);
                if (words.length === 0) {
                    console.error('No valid 5-letter words found in words.txt');
                    message = document.getElementById('message');
                    message.textContent = 'Error: No valid words available.';
                    return;
                }
                secret = words[Math.floor(Math.random() * words.length)];
                grid = document.getElementById('gameGrid');
                progressGrid = document.getElementById('progressGrid');
                message = document.getElementById('message');
                document.getElementById('score').textContent = `Score: ${score}`; // Initialize score display
                createGrid();
                createProgressGrid();
                createKeyboard();
                // Add event listeners
                document.getElementById('guessInput').addEventListener('keyup', (event) => {
                    if (event.key === 'Enter' && attempts < maxAttempts && !gameEnded) makeGuess(); // Enter for guessing
                });
                document.getElementById('guessButton').addEventListener('click', makeGuess);
                document.getElementById('playAgainButton').addEventListener('click', playAgain);
                document.getElementById('hintButton').addEventListener('click', getHint);
                // Add Shift+Enter for Play Again after game end
                document.addEventListener('keydown', (event) => {
                    const playAgainButton = document.getElementById('playAgainButton');
                    if (event.key === 'Enter' && event.shiftKey && playAgainButton.style.display === 'block' && !document.getElementById('guessInput').value) {
                        playAgain();
                        event.preventDefault(); // Prevent default Enter behavior
                    }
                });
            })
            .catch(error => {
                console.error('Error loading words.txt:', error);
                message = document.getElementById('message');
                message.textContent = 'Error loading word list. Please try again later.';
            });

        function createGrid() {
            if (!grid) {
                console.error('Grid element not found');
                return;
            }
            grid.innerHTML = ''; // Clear previous grid
            for (let i = 0; i < maxAttempts * 5;
